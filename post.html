<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>DevNotes Article</title>
<link rel="stylesheet" href="style.css">
</head>

<body>

<header class="nav">
<div class="logo">DevNotes</div>
<a href="index.html">Home</a>
</header>

<div class="article">
<h1 id="title"></h1>
<div class="meta" id="meta"></div>
<div id="content"></div>
</div>
<hr style="margin:40px 0;border:1px solid #1e293b">

<h2>Comments</h2>

<div id="comments"></div>

<div class="form-box">
<input id="cname" placeholder="Your name">
<textarea id="cmsg" placeholder="Write a comment..."></textarea>
<button onclick="addComment()">Post Comment</button>
</div>

<script src="data.js"></script>

<script>
let posts = JSON.parse(localStorage.getItem("posts")) || blogPosts;
let id = new URLSearchParams(window.location.search).get("id");
let post = posts[id];

document.getElementById("title").innerText = post.title;
document.getElementById("meta").innerText = post.date + " â€¢ " + post.author;
document.getElementById("content").innerHTML = post.content;
</script>
<script>
let postId = id;   // uses same id from article script

function loadComments(){
    let all = JSON.parse(localStorage.getItem("comments")) || {};
    let postComments = all[postId] || [];

    let html="";
    postComments.forEach(c=>{
        html+=`
        <div class="card">
            <strong>${c.name}</strong>
            <div class="meta">${c.date}</div>
            <p>${c.text}</p>
        </div>`;
    });

    document.getElementById("comments").innerHTML = html || "<p>No comments yet.</p>";
}

function addComment(){
    let name = cname.value.trim();
    let text = cmsg.value.trim();

    if(!name || !text){
        alert("Write name & comment");
        return;
    }

    let all = JSON.parse(localStorage.getItem("comments")) || {};
    if(!all[postId]) all[postId]=[];

    all[postId].push({
        name:name,
        text:text,
        date:new Date().toLocaleString()
    });

    localStorage.setItem("comments", JSON.stringify(all));

    cname.value="";
    cmsg.value="";

    loadComments();
}

loadComments();
</script>

</body>
</html>
